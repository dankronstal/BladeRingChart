{"visual":{"name":"bladeRingChart","displayName":"Blade/Ring Chart","guid":"PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.1.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Blade","name":"category","kind":0},{"displayName":"Ring","name":"series","kind":0},{"displayName":"Value","name":"measure","kind":1}],"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"category"}},"values":{"group":{"by":"series","select":[{"for":{"in":"measure"}}]}}}}],"objects":{"enableAxis":{"displayName":"Enable Axis","properties":{"show":{"displayName":"Enable Axis","type":{"bool":true}}}},"colorSelector":{"displayName":"Data Colors","properties":{"fill":{"displayName":"Color","type":{"fill":{"solid":{"color":true}}}}}}}},"content":{"js":"/*\r\n *  Power BI Visual CLI\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                ;\r\n                ;\r\n                /**\r\n                 * Function that converts queried data into a view model that will be used by the visual.\r\n                 *\r\n                 * @function\r\n                 * @param {VisualUpdateOptions} options - Contains references to the size of the container\r\n                 *                                        and the dataView which contains all the data\r\n                 *                                        the visual had queried.\r\n                 * @param {IVisualHost} host            - Contains references to the host which contains services\r\n                 */\r\n                function visualTransform(options, host) {\r\n                    var dataViews = options.dataViews;\r\n                    var defaultSettings = {\r\n                        enableAxis: {\r\n                            show: false,\r\n                        },\r\n                        rScale: null,\r\n                        sizeDegrees: 0,\r\n                        bladeAngles: [],\r\n                        fillValue: [],\r\n                        ringConfig: {},\r\n                        l: 0,\r\n                        alignmentPos: -1,\r\n                        bladeList: [],\r\n                        ringList: [],\r\n                        arcFills: 0\r\n                    };\r\n                    var viewModel = {\r\n                        dataPoints: [],\r\n                        dataPointTooltips: [],\r\n                        ringMax: [],\r\n                        ringMin: [],\r\n                        settings: {}\r\n                    };\r\n                    if (!dataViews\r\n                        || !dataViews[0]\r\n                        || !dataViews[0].categorical\r\n                        || !dataViews[0].categorical.categories[0]\r\n                        || !dataViews[0].categorical.values[0])\r\n                        return viewModel;\r\n                    var categorical = dataViews[0].categorical;\r\n                    var categories = categorical.categories;\r\n                    var values = categorical.values;\r\n                    var bladeRingDataPoints = [];\r\n                    var bladeRingDataPointTts = [];\r\n                    var dataMax = 0;\r\n                    var dataMin = 99999;\r\n                    var colorPalette = PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.createColorPalette(host.colors).reset();\r\n                    var objects = dataViews[0].metadata.objects;\r\n                    var bladeRingChartSettings = {\r\n                        enableAxis: {\r\n                            show: PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getValue(objects, 'enableAxis', 'show', defaultSettings.enableAxis.show),\r\n                        },\r\n                        rScale: null,\r\n                        sizeDegrees: 0,\r\n                        bladeAngles: [],\r\n                        fillValue: [],\r\n                        ringConfig: null,\r\n                        l: 0,\r\n                        alignmentPos: -1,\r\n                        bladeList: [],\r\n                        ringList: [],\r\n                        arcFills: 0\r\n                    };\r\n                    var ringConfig = { radius: 40, width: 20, offset: 1 }; //TODO: move to Objects\r\n                    var ringMin = [];\r\n                    var ringMax = [];\r\n                    var bladeList = [];\r\n                    var ringList = [];\r\n                    var r;\r\n                    var b;\r\n                    var bladeAngles = [];\r\n                    var fillValue = [];\r\n                    function deepIndexOf(arr, obj) {\r\n                        return arr.findIndex(function (cur) {\r\n                            return Object.keys(obj).every(function (key) {\r\n                                return obj[key] === cur[key];\r\n                            });\r\n                        });\r\n                    }\r\n                    function degreesToRadians(d) {\r\n                        var r = 0;\r\n                        r = d * (Math.PI / 180);\r\n                        return r;\r\n                    }\r\n                    function radiansToDegrees(d) {\r\n                        return d * 57.2958;\r\n                    }\r\n                    for (var i_1 = 0, lenC = categories[0].values.length; i_1 < lenC; i_1++) {\r\n                        for (var j = 0, lenV = values.length; j < lenV; j++) {\r\n                            var defaultColor = {\r\n                                solid: {\r\n                                    color: colorPalette.getColor(categories[0].values[i_1]).value\r\n                                }\r\n                            };\r\n                            var blade = categories[0].values[i_1] == null ? \"null\" : categories[0].values[i_1];\r\n                            var value = values[j].values[i_1] == null ? 0 : values[j].values[i_1];\r\n                            var ring = values[j].source.groupName;\r\n                            if (bladeList.map(function (x) { return x; }).indexOf(blade) == -1) {\r\n                                bladeList[bladeList.length] = blade;\r\n                            }\r\n                            if (ringList.map(function (x) { return x; }).indexOf(ring) == -1) {\r\n                                ringList[ringList.length] = ring;\r\n                            }\r\n                            b = bladeList.map(function (x) { return x; }).indexOf(blade);\r\n                            r = ringList.map(function (x) { return x; }).indexOf(ring);\r\n                            ringMin[r] = isNaN(ringMin[r]) || ringMin[r] > Number(value) ? Number(value) : ringMin[r];\r\n                            ringMax[r] = isNaN(ringMax[r]) || ringMax[r] < Number(value) ? Number(value) : ringMax[r];\r\n                            bladeRingDataPoints.push({\r\n                                bladeLabel: blade,\r\n                                blade: b,\r\n                                ringLabel: ring,\r\n                                ring: r,\r\n                                value: value,\r\n                                color: PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getCategoricalObjectValue(blade, b, 'colorSelector', 'fill', defaultColor).solid.color,\r\n                                startPos: 0,\r\n                                selectionId: host.createSelectionIdBuilder()\r\n                                    .withCategory(categorical.categories[0], j)\r\n                                    .createSelectionId()\r\n                            });\r\n                            dataMax = value > dataMax ? value : dataMax;\r\n                            dataMin = value < dataMin && value > 0 ? value : dataMin;\r\n                            bladeRingDataPointTts.push(\"Blade = \" + blade + \"; Ring = \" + ring + \"; Value = \" + value);\r\n                        }\r\n                    }\r\n                    bladeRingChartSettings.sizeDegrees = 360 / bladeList.length;\r\n                    bladeRingDataPoints.sort(function (a, b) {\r\n                        if (a.ring === b.ring) {\r\n                            var x = a.value, y = b.value;\r\n                            return x > y ? -1 : x < y ? 1 : 0;\r\n                        }\r\n                        return a.ring - b.ring;\r\n                    });\r\n                    bladeRingDataPoints.forEach(function (d, i) {\r\n                        if (bladeAngles[d.blade] != null)\r\n                            return;\r\n                        bladeAngles[d.blade] = Math.floor(radiansToDegrees(degreesToRadians((d.blade * bladeRingChartSettings.sizeDegrees - .15 * d.ring))));\r\n                    });\r\n                    for (var i = 0; i < ringMax.length; i++) {\r\n                        fillValue[i] = d3.scale.linear().domain([ringMin[i], ringMax[i]]).range([2, ringConfig.width]);\r\n                    }\r\n                    bladeRingChartSettings.rScale = d3.scale.linear().domain([dataMin, dataMax]).range([5, 20]); //todo: fix hardcoding\r\n                    bladeRingChartSettings.bladeAngles = bladeAngles;\r\n                    bladeRingChartSettings.ringConfig = ringConfig;\r\n                    bladeRingChartSettings.l = bladeList.length > ringList.length ? bladeAngles.length - 1 : ringList.length - 1;\r\n                    bladeRingChartSettings.bladeList = bladeList;\r\n                    bladeRingChartSettings.ringList = ringList;\r\n                    bladeRingChartSettings.arcFills = 0;\r\n                    bladeRingChartSettings.fillValue = fillValue;\r\n                    return {\r\n                        dataPoints: bladeRingDataPoints,\r\n                        dataPointTooltips: bladeRingDataPointTts,\r\n                        ringMax: ringMax,\r\n                        ringMin: ringMin,\r\n                        settings: bladeRingChartSettings\r\n                    };\r\n                }\r\n                function collide(n) {\r\n                    var r = n.radius + 100, nx1 = n.x - r, nx2 = n.x + r, ny1 = n.y - r, ny2 = n.y + r;\r\n                    return function (quad, x1, y1, x2, y2) {\r\n                        if (quad.point && (quad.point !== n)) {\r\n                            var x = n.x - quad.point.x, y = n.y - quad.point.y, l = Math.sqrt(x * x + y * y), r = n.radius + quad.point.radius;\r\n                            if (l < r) {\r\n                                l = (l - r) / r * 0.5;\r\n                                n.x -= x *= l;\r\n                                n.y -= y *= l;\r\n                                quad.point.x += x;\r\n                                quad.point.y += y;\r\n                            }\r\n                        }\r\n                        return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;\r\n                    };\r\n                }\r\n                var Visual = (function () {\r\n                    /**\r\n                     * Creates instance of bladeRingChart. This method is only called once.\r\n                     *\r\n                     * @constructor\r\n                     * @param {VisualConstructorOptions} options - Contains references to the element that will\r\n                     *                                             contain the visual and a reference to the host\r\n                     *                                             which contains services.\r\n                     */\r\n                    function Visual(options) {\r\n                        var data = [];\r\n                        this.host = options.host;\r\n                        this.selectionManager = options.host.createSelectionManager();\r\n                        var svg = this.svg = d3.select(options.element)\r\n                            .append('svg')\r\n                            .classed('bladeRingChart', true);\r\n                        this.bladeRingContainer = svg.append('g')\r\n                            .classed('bladeRingContainer', true)\r\n                            .attr(\"transform\", \"translate(250,250)\");\r\n                        this.slices = this.bladeRingContainer.selectAll(\"path\");\r\n                        this.dataColors = d3.scale.category20();\r\n                        this.updateCount = 0;\r\n                    }\r\n                    /**\r\n                     * Updates the state of the visual. Every sequential databinding and resize will call update.\r\n                     *\r\n                     * @function\r\n                     * @param {VisualUpdateOptions} options - Contains references to the size of the container\r\n                     *                                        and the dataView which contains all the data\r\n                     *                                        the visual had queried.\r\n                     */\r\n                    Visual.prototype.update = function (options) {\r\n                        var width = options.viewport.width;\r\n                        var height = options.viewport.height;\r\n                        function arcFillValue(j) {\r\n                            for (var i = 0; i < viewModel.ringMax.length; i++) {\r\n                                fillValue[i] = d3.scale.linear().domain([viewModel.ringMin[i], viewModel.ringMax[i]]).range([2, settings.ringConfig.width]);\r\n                            }\r\n                        }\r\n                        function innerRadius(i) {\r\n                            return settings.ringConfig.radius + (i * settings.ringConfig.width) + (i * settings.ringConfig.offset);\r\n                        }\r\n                        function fillRadius(i, d) {\r\n                            return settings.ringConfig.width + (d.ring + 1 <= fillValue.length ? fillValue[d.ring](d.value) : 50) + ((i + 1) * settings.ringConfig.width) + (i * settings.ringConfig.offset);\r\n                        }\r\n                        function degreesToRadians(d) {\r\n                            var r = 0;\r\n                            r = d * (Math.PI / 180);\r\n                            return r;\r\n                        }\r\n                        function radiansToDegrees(d) {\r\n                            return d * 57.2958;\r\n                        }\r\n                        function uniq(a) {\r\n                            return a.sort().filter(function (item, pos, ary) {\r\n                                return !pos || item != ary[pos - 1];\r\n                            });\r\n                        }\r\n                        var viewModel = visualTransform(options, this.host);\r\n                        var selectionManager = this.selectionManager;\r\n                        var settings = this.bladeRingChartSettings = viewModel.settings;\r\n                        this.bladeRingDataPoints = viewModel.dataPoints;\r\n                        var bladeRingDataPoints = this.bladeRingDataPoints;\r\n                        var fillValue = settings.fillValue;\r\n                        var sizeDegrees = this.bladeRingChartSettings.sizeDegrees;\r\n                        this.ringMax;\r\n                        this.sizeDegrees;\r\n                        this.bladeOffset = [];\r\n                        this.pos = -1;\r\n                        this.l;\r\n                        //early bail-out in case we're still setting up data\r\n                        if (bladeRingDataPoints.length == 0)\r\n                            return;\r\n                        var arcFills = d3.svg.arc()\r\n                            .innerRadius(function (d, i) { return innerRadius(bladeRingDataPoints[i].ring); })\r\n                            .outerRadius(function (d, i) { return fillRadius(bladeRingDataPoints[i].ring, bladeRingDataPoints[i]); })\r\n                            .startAngle(function (d, i) { return degreesToRadians(i * sizeDegrees - .15 * bladeRingDataPoints[i].ring); })\r\n                            .endAngle(function (d, i) { return degreesToRadians((i * sizeDegrees) + sizeDegrees - 2); });\r\n                        this.svg.attr({\r\n                            width: width,\r\n                            height: height,\r\n                        });\r\n                        if (this.updateCount == 0) {\r\n                            //initial setup (counting on having a chance to draw svg's before data changes)\r\n                            this.bladeAngles = settings.bladeAngles;\r\n                            this.ringList = settings.ringList;\r\n                            this.bladeList = settings.bladeList;\r\n                            this.l = settings.l;\r\n                            var that_1 = this;\r\n                            for (var i = 0; i < viewModel.ringMax.length; i++) {\r\n                                fillValue[i] = d3.scale.linear().domain([viewModel.ringMin[i], viewModel.ringMax[i]]).range([1, settings.ringConfig.width]);\r\n                            }\r\n                            this.slices = this.slices.data(this.bladeRingDataPoints)\r\n                                .enter()\r\n                                .append(\"g\");\r\n                            this.slices.append(\"svg:title\").text(function (d, i) { return \"Province: [\" + bladeRingDataPoints[i].bladeLabel + \"] Category: [\" + bladeRingDataPoints[i].ringLabel + \"] Value: [\" + bladeRingDataPoints[i].value + \"]\"; });\r\n                            this.slices.append(\"svg:path\")\r\n                                .attr(\"id\", function (d, i) { return \"b\" + bladeRingDataPoints[i].blade + \"r\" + bladeRingDataPoints[i].ring + \"f\"; })\r\n                                .attr(\"bladeLabel\", function (d, i) { return bladeRingDataPoints[i].bladeLabel; })\r\n                                .attr(\"ringLabel\", function (d, i) { return bladeRingDataPoints[i].ringLabel; })\r\n                                .attr(\"v\", function (d, i) { return bladeRingDataPoints[i].value; })\r\n                                .attr(\"f\", function (d, i) { return fillValue[bladeRingDataPoints[i].ring](bladeRingDataPoints[i].value); })\r\n                                .attr(\"currPos\", function (d, i) {\r\n                                bladeRingDataPoints[i].startPos = i - (bladeRingDataPoints[i].ring * (settings.bladeList.length - 1)) - bladeRingDataPoints[i].ring; //set starting position based on sorted position\r\n                                return bladeRingDataPoints[i].startPos;\r\n                            })\r\n                                .style(\"fill\", function (d, i) {\r\n                                return bladeRingDataPoints[i].color;\r\n                            })\r\n                                .attr(\"d\", arcFills);\r\n                            this.slices.on(\"click\", function (d, i) {\r\n                                selectionManager.select(bladeRingDataPoints[i].selectionId);\r\n                                that_1.updateCount++;\r\n                                that_1.update(options);\r\n                            });\r\n                        }\r\n                        else {\r\n                            this.reDraw(bladeRingDataPoints, settings);\r\n                        }\r\n                        this.updateCount++;\r\n                    };\r\n                    Visual.prototype.reDraw = function (bladeRingDataPoints, settings) {\r\n                        var activeblade = this.bladeList.indexOf(bladeRingDataPoints[0].bladeLabel);\r\n                        var samebladePrefix = \"b\" + activeblade + \"r\";\r\n                        //var sameblade = d3.selectAll('[id*='+samebladePrefix+']')._groups[0]; //d3v4\r\n                        var sameblade = d3.selectAll('[id*=' + samebladePrefix + ']')[0]; //d3v3\r\n                        var bladeOffsets = [];\r\n                        var bladeAngles = this.bladeAngles;\r\n                        //shade all, according to selection\r\n                        if (bladeRingDataPoints.length > this.bladeList.length) {\r\n                            this.slices.style(\"fill-opacity\", \"1\"); //no selection\r\n                        }\r\n                        else {\r\n                            this.slices.style(\"fill-opacity\", \"0.25\"); //selection\r\n                        }\r\n                        sameblade.forEach(function (r, i) {\r\n                            //bladeOffsets[i]=d3.select(d3.selectAll('[id*='+samebladePrefix+']')._groups[0][i]).attr(\"currPos\"); //d3v4\r\n                            bladeOffsets[i] = d3.selectAll('[id*=' + samebladePrefix + i + ']').attr(\"currPos\"); //d3v3         \r\n                            //unshade selected\r\n                            d3.select(d3.selectAll('[id*=' + samebladePrefix + i + ']').node().parentNode).style(\"fill-opacity\", \"1\");\r\n                        });\r\n                        for (var i = 0; i < bladeOffsets.length; i++) {\r\n                            do {\r\n                                if (bladeOffsets[i] > this.l)\r\n                                    bladeOffsets[i] -= this.l;\r\n                            } while (bladeOffsets[i] > this.l);\r\n                            bladeOffsets[i] = 0 - bladeOffsets[i];\r\n                        }\r\n                        //apply transition\r\n                        for (var r = 0; r <= this.l; r++) {\r\n                            d3.selectAll(\"[id$=r\" + r + \"f]\")\r\n                                .transition()\r\n                                .duration(750)\r\n                                .attr(\"transform\", function (p, h) {\r\n                                var currPos = parseInt(d3.select(\"#b\" + activeblade + \"r\" + p.ring + \"f\").attr(\"currPos\")) + parseInt(bladeOffsets[r]);\r\n                                var rotateBy = Math.abs(bladeOffsets[r] + settings.alignmentPos) > bladeAngles.length - 1 ? Math.abs(bladeOffsets[r] + settings.alignmentPos) - (bladeAngles.length) : bladeOffsets[r] + settings.alignmentPos;\r\n                                var appliedAngle = 0;\r\n                                if (bladeRingDataPoints.length > settings.ringList.length) {\r\n                                    appliedAngle = bladeAngles[bladeRingDataPoints[i].startPos];\r\n                                }\r\n                                else {\r\n                                    appliedAngle = 0 + (bladeOffsets[r] + settings.alignmentPos > 0 ? bladeAngles[Math.abs(rotateBy)] : -1 * bladeAngles[Math.abs(rotateBy)].valueOf());\r\n                                }\r\n                                return \"rotate(\" + (appliedAngle) + \")\"; //default rotation ends arc angles right-hand edge at 90 degrees\r\n                            });\r\n                        }\r\n                    };\r\n                    Visual.prototype.defaultSort = function (arr) {\r\n                        return arr.sort(function (a, b) {\r\n                            if (a.ring === b.ring) {\r\n                                var x = a.value, y = b.value;\r\n                                return x > y ? -1 : x < y ? 1 : 0;\r\n                            }\r\n                            return a.ring - b.ring;\r\n                        });\r\n                    };\r\n                    /**\r\n                     * Enumerates through the objects defined in the capabilities and adds the properties to the format pane\r\n                     *\r\n                     * @function\r\n                     * @param {EnumerateVisualObjectInstancesOptions} options - Map of defined objects\r\n                     */\r\n                    Visual.prototype.enumerateObjectInstances = function (options) {\r\n                        var objectName = options.objectName;\r\n                        var objectEnumeration = [];\r\n                        switch (objectName) {\r\n                            case 'enableAxis':\r\n                                objectEnumeration.push({\r\n                                    objectName: objectName,\r\n                                    properties: {\r\n                                        show: this.bladeRingChartSettings.enableAxis.show,\r\n                                    },\r\n                                    selector: null\r\n                                });\r\n                                break;\r\n                            case 'colorSelector':\r\n                                for (var _i = 0, _a = this.bladeRingDataPoints; _i < _a.length; _i++) {\r\n                                    var bladeRingDataPoint = _a[_i];\r\n                                    objectEnumeration.push({\r\n                                        objectName: objectName,\r\n                                        displayName: bladeRingDataPoint.bladeLabel,\r\n                                        properties: {\r\n                                            fill: {\r\n                                                solid: {\r\n                                                    color: bladeRingDataPoint.color\r\n                                                }\r\n                                            }\r\n                                        },\r\n                                        selector: bladeRingDataPoint.selectionId.getSelector()\r\n                                    });\r\n                                }\r\n                                break;\r\n                        }\r\n                        ;\r\n                        return objectEnumeration;\r\n                    };\r\n                    /**\r\n                     * Destroy runs when the visual is removed. Any cleanup that the visual needs to\r\n                     * do should be done here.\r\n                     *\r\n                     * @function\r\n                     */\r\n                    Visual.prototype.destroy = function () {\r\n                        //Perform any cleanup tasks here\r\n                    };\r\n                    Visual.Config = {\r\n                        xScalePadding: 0.1,\r\n                        solidOpacity: 1,\r\n                        transparentOpacity: 0.5,\r\n                        margins: {\r\n                            top: 0,\r\n                            right: 0,\r\n                            bottom: 25,\r\n                            left: 30,\r\n                        },\r\n                        xAxisFontMultiplier: 0.04,\r\n                    };\r\n                    return Visual;\r\n                }());\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.Visual = Visual;\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                /**\r\n                 * Singleton reference of ColorPalette.\r\n                 *\r\n                 * @instance\r\n                 */\r\n                var colorManager;\r\n                /**\r\n                 * Factory method for creating a ColorPalette.\r\n                 *\r\n                 * @function\r\n                 * @param {IColorInfo[]} colors - Array of ColorInfo objects that contain\r\n                 *                                hex values for colors.\r\n                 */\r\n                function createColorPalette(colors) {\r\n                    if (!colorManager)\r\n                        colorManager = new ColorPalette(colors);\r\n                    return colorManager;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.createColorPalette = createColorPalette;\r\n                var ColorPalette = (function () {\r\n                    function ColorPalette(colors) {\r\n                        this.colorPalette = {};\r\n                        this.colorIndex = 0;\r\n                        this.colors = colors;\r\n                    }\r\n                    /**\r\n                     * Gets color from colorPalette and returns an IColorInfo\r\n                     *\r\n                     * @function\r\n                     * @param {string} key - Key of assign color in colorPalette.\r\n                     */\r\n                    ColorPalette.prototype.getColor = function (key) {\r\n                        var color = this.colorPalette[key];\r\n                        if (color) {\r\n                            return color;\r\n                        }\r\n                        var colors = this.colors;\r\n                        color = this.colorPalette[key] = colors[this.colorIndex++];\r\n                        if (this.colorIndex >= colors.length) {\r\n                            this.colorIndex = 0;\r\n                        }\r\n                        return color;\r\n                    };\r\n                    /**\r\n                     * resets colorIndex to 0\r\n                     *\r\n                     * @function\r\n                     */\r\n                    ColorPalette.prototype.reset = function () {\r\n                        this.colorIndex = 0;\r\n                        return this;\r\n                    };\r\n                    /**\r\n                     * Clears colorPalette of cached keys and colors\r\n                     *\r\n                     * @function\r\n                     */\r\n                    ColorPalette.prototype.clear = function () {\r\n                        this.colorPalette = {};\r\n                    };\r\n                    return ColorPalette;\r\n                }());\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                /**\r\n                 * Gets property value for a particular object.\r\n                 *\r\n                 * @function\r\n                 * @param {DataViewObjects} objects - Map of defined objects.\r\n                 * @param {string} objectName       - Name of desired object.\r\n                 * @param {string} propertyName     - Name of desired property.\r\n                 * @param {T} defaultValue          - Default value of desired property.\r\n                 */\r\n                function getValue(objects, objectName, propertyName, defaultValue) {\r\n                    if (objects) {\r\n                        var object = objects[objectName];\r\n                        if (object) {\r\n                            var property = object[propertyName];\r\n                            if (property !== undefined) {\r\n                                return property;\r\n                            }\r\n                        }\r\n                    }\r\n                    return defaultValue;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getValue = getValue;\r\n                /**\r\n                 * Gets property value for a particular object in a category.\r\n                 *\r\n                 * @function\r\n                 * @param {DataViewCategoryColumn} category - List of category objects.\r\n                 * @param {number} index                    - Index of category object.\r\n                 * @param {string} objectName               - Name of desired object.\r\n                 * @param {string} propertyName             - Name of desired property.\r\n                 * @param {T} defaultValue                  - Default value of desired property.\r\n                 */\r\n                function getCategoricalObjectValue(category, index, objectName, propertyName, defaultValue) {\r\n                    var categoryObjects = category.objects;\r\n                    if (categoryObjects) {\r\n                        var categoryObject = categoryObjects[index];\r\n                        if (categoryObject) {\r\n                            var object = categoryObject[objectName];\r\n                            if (object) {\r\n                                var property = object[propertyName];\r\n                                if (property !== undefined) {\r\n                                    return property;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return defaultValue;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getCategoricalObjectValue = getCategoricalObjectValue;\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var visuals;\r\n    (function (visuals) {\r\n        var plugins;\r\n        (function (plugins) {\r\n            plugins.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG = {\r\n                name: 'PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG',\r\n                displayName: 'Blade/Ring Chart',\r\n                class: 'Visual',\r\n                version: '1.0.0',\r\n                apiVersion: '1.1.0',\r\n                create: function (options) { return new powerbi.extensibility.visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.Visual(options); },\r\n                custom: true\r\n            };\r\n        })(plugins = visuals.plugins || (visuals.plugins = {}));\r\n    })(visuals = powerbi.visuals || (powerbi.visuals = {}));\r\n})(powerbi || (powerbi = {}));\r\n//# sourceMappingURL=visual.js.map","css":".visual-PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG p {\n  font-size: 20px;\n  font-weight: bold;\n}\n.visual-PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG p em {\n  background: yellow;\n  padding: 5px;\n}\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AsVEiUYLroYMQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAC3klEQVQ4y62Vy29bRRjFfzP35Xt9nbg3dh6OpRRHpS9SxCNlwaoiCzZdwApY84fwJ/A3ILFlj4SKRFNFLEgrtSxoaUljHJI4fiS2r+/1Hd9hYeMSKU5A6rcZfdLM0TnfOTMjNjY2NK+xTIDPbxVZL+dIhpq+GhIOUmqdAT9XT/i9Ef1/QJVqUq2RErK2QdY2mPctbpd9/mjFfP2g9p8BJYApBY4psaTAEAIADSRDzeP9Hl++v8hnt4pkTHEhoFGpVL6qe0OeyIjaTkSrr/BtEzFmXm3HLM86eLZkvTzDYS+h1VfnS+74eYbLReqlkT8/xIrL8QHOb0OuzLkjukCqNXevBfxS67L58mS65JFGjdagNQjbZHe2zNZuh28eHrJ7/MoYDby37PNOyZ8OmIYJqh3BMEUYAiEF/WdHfPF2kTuVWb77tcG9520cQ05A77wxy+W8M8XlA00UglZdhGljVxRrzR7ZxSyrgUtpxuHbR4eEScrdawFaw9NGn4NYnm2KtF2k4yKkAcBgL2TvqEXOMSh4FqYUXC243N85IRlqqscxTzomuVwOKSVxHJ8xw39VLvIpuGv8+OKYx/s9YJTPT2/Osb3XZTdxcRwHrTW+758hudsCNNLOgDRZzK5jSgfPLLBVvUekUnKOSaufAFCv11laWkKMMxsEAc1m8zRD1W0zaO4zOPqTJA1JtcKz5liZ+ZCHf/VoR4pC1uKtBQ+AKIrG4dBkMpnzJT9rfc9xXCNSbRx7G4CnRyFSCBZ8G4AwDE+d+QdUTkt8tbPFWmmbT27Mkc+YRErT7iu0hutF95QRAJZlnQ8I8ODlCbHSfLSaB2CnHSEFzI9ZxnFMmqaTdWLKtDrsJTT6CYE32tYIFY3w1V1uNRu8W/IJfJMwMdjsXcAQ4KfnV9h88cGkvz7v8fGbAQAreYfb5RwrlzJccs2LJQMEmVUWvJuT3rMM5PgVi5Um1ZBqkOMIidf9BfwNqTY2cgdZxuwAAAAASUVORK5CYII="}}